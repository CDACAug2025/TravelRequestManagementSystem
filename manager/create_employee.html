<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Create Employee</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../css/style.css">
</head>

<body>
  <div class="container">
    <div class="header">
      <h2>Create Employee</h2>
      <nav>
        <a href="info.html">My Info</a>
        <a href="new_request.html">New Request</a>
        <a href="all_requests.html">My Requests</a>
        <a href="approve_requests.html">Approve Requests</a>
        <a class="logout" href="#" onclick="logout()">Logout</a>
      </nav>
    </div>
    <div id="form" class="card">
      <div class="card-header">
        <h3 class="card-title">Create New Employee</h3>
      </div>
      <div class="form-group">
        <label>First Name</label>
        <input id="first" placeholder="First Name">
      </div>
      <div class="form-group">
        <label>Last Name</label>
        <input id="last" placeholder="Last Name">
      </div>
      <div class="form-group">
        <label>Email</label>
        <input id="email" type="email" placeholder="email@company.com">
      </div>
      <div class="form-group">
        <label>Department</label>
        <input id="dept" placeholder="Department">
      </div>
      <div class="form-group">
        <label>Manager ID (optional)</label>
        <input id="manager" type="number" placeholder="Manager ID">
      </div>
      <div class="form-group">
        <label>Role</label>
        <select id="role">
          <option value="Employee">Employee</option>
          <option value="Manager">Manager</option>
        </select>
      </div>
      <button id="create" class="btn success">Create Employee</button>
      <div id="msg" style="display:none" class="message"></div>
    </div>
  </div>
  <script src="../js/mock_data.js"></script>
  <script src="../js/shared.js"></script>
  <script>
  (function () {
    const u = getLoggedIn();
    if (!u) {
      location = '/index.html';
      return;
    }

    document.getElementById('create').addEventListener('click', function (e) {
      e.preventDefault();

      // Remove old error messages
      document.querySelectorAll('.error').forEach(el => el.remove());
      document.querySelectorAll('input, select').forEach(el => el.classList.remove('invalid'));

      let valid = true;

      // Helper to show errors next to input
      function showError(id, message) {
        const input = document.getElementById(id);
        input.classList.add('invalid');
        const err = document.createElement('span');
        err.className = 'error';
        err.style.color = 'red';
        err.style.marginLeft = '10px';
        err.textContent = message;
        input.parentNode.insertBefore(err, input.nextSibling);
        valid = false;
      }

      const fn = document.getElementById('first').value.trim();
      const ln = document.getElementById('last').value.trim();
      const email = document.getElementById('email').value.trim();
      const dept = document.getElementById('dept').value.trim();
      const manager = document.getElementById('manager').value.trim();
      const role = document.getElementById('role').value;

      // Validation checks
      if (!fn) showError('first', 'Required');
      if (!ln) showError('last', 'Required');
      if (!email) showError('email', 'Required');
      else if (!email.includes('@')) showError('email', 'Invalid email');
      if (!dept) showError('dept', 'Required');
      if (manager && isNaN(manager)) showError('manager', 'Must be a number');
      if (!role) showError('role', 'Select a role');

      // Show message box
      const msg = document.getElementById('msg');
      msg.style.display = 'block';
      if (valid) {
        msg.textContent = 'Form is valid! (No data will be saved)';
        msg.className = 'message success';
      } else {
        msg.textContent = 'Please fix the errors above.';
        msg.className = 'message error';
      }
    });
  })();
</script>

</body>

</html>